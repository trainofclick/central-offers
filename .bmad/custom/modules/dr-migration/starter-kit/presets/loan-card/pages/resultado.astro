---
/**
 * Results Page - LOAN-CARD Preset
 * P√°gina de resultados com ofertas de parceiros
 */
import BaseLayout from "@layouts/BaseLayout.astro";
import Section from "@components/astro/Section.astro";
import Card from "@components/astro/Card.astro";
import Button from "@components/astro/Button.astro";

const pageTitle = "Suas Ofertas Personalizadas";
const pageDescription = "Confira as melhores ofertas de cr√©dito selecionadas para voc√™";

// Partner offers (in production, these would come from API/database)
const offers = [
  {
    id: 1,
    partnerName: "Banco Premium",
    logo: "üè¶",
    type: "Cart√£o de Cr√©dito",
    title: "Cart√£o Platinum sem anuidade",
    benefits: [
      "Limite de at√© R$ 15.000",
      "Cashback de 2% em todas as compras",
      "Anuidade ZERO no primeiro ano",
      "Aceito em milh√µes de estabelecimentos",
    ],
    cta: "SOLICITAR AGORA",
    ctaUrl: "#",
    highlight: true,
  },
  {
    id: 2,
    partnerName: "Fintech Digital",
    logo: "üí≥",
    type: "Empr√©stimo Pessoal",
    title: "Empr√©stimo de at√© R$ 50.000",
    benefits: [
      "Taxa a partir de 1,99% ao m√™s",
      "At√© 36x para pagar",
      "Dinheiro na conta em 24h",
      "Sem consulta ao SPC/Serasa",
    ],
    cta: "VER OFERTA",
    ctaUrl: "#",
    highlight: false,
  },
  {
    id: 3,
    partnerName: "Cr√©dito F√°cil",
    logo: "üí∞",
    type: "Cr√©dito Consignado",
    title: "Consignado para Aposentados",
    benefits: [
      "Taxas a partir de 1,2% ao m√™s",
      "At√© 84x para pagar",
      "Desconto direto do INSS",
      "Aprova√ß√£o em minutos",
    ],
    cta: "SIMULAR AGORA",
    ctaUrl: "#",
    highlight: false,
  },
  {
    id: 4,
    partnerName: "Super Card",
    logo: "üéØ",
    type: "Cart√£o de Cr√©dito",
    title: "Cart√£o Gold com Milhas",
    benefits: [
      "Acumule milhas em compras",
      "Programa de pontos exclusivo",
      "Limite pr√©-aprovado",
      "App com controle de gastos",
    ],
    cta: "PEDIR CART√ÉO",
    ctaUrl: "#",
    highlight: false,
  },
];
---

<BaseLayout title={pageTitle} description={pageDescription}>
  <!-- Success Header -->
  <Section background="gradient" padding="lg">
    <div class="text-center max-w-3xl mx-auto">
      <div class="text-6xl mb-4">‚úÖ</div>
      <h1 class="text-3xl md:text-4xl font-bold text-secondary mb-4">
        An√°lise Conclu√≠da!
      </h1>
      <p class="text-xl text-text-muted mb-2">
        Encontramos <strong class="text-primary">{offers.length} ofertas</strong
        > perfeitas para o seu perfil
      </p>
      <p class="text-sm text-text-muted">
        Compare e escolha a melhor op√ß√£o para voc√™
      </p>
    </div>
  </Section>

  <!-- Offers Section -->
  <Section padding="lg">
    <div class="max-w-5xl mx-auto">
      <div class="grid gap-6">
        {
          offers.map((offer) => (
            <Card
              variant={offer.highlight ? "elevated" : "default"}
              class={`relative ${offer.highlight ? "border-2 border-primary shadow-xl" : ""}`}
            >
              {offer.highlight && (
                <div class="absolute -top-3 left-1/2 -translate-x-1/2 px-4 py-1 bg-primary text-white text-sm font-bold rounded-full">
                  MELHOR OFERTA
                </div>
              )}

              <div class="md:flex gap-6 items-start">
                {/* Partner Logo */}
                <div class="flex-shrink-0 mb-4 md:mb-0">
                  <div class="w-24 h-24 bg-gradient-to-br from-primary/10 to-primary/20 rounded-2xl flex items-center justify-center text-5xl">
                    {offer.logo}
                  </div>
                </div>

                {/* Offer Details */}
                <div class="flex-1">
                  <div class="mb-4">
                    <div class="text-sm text-primary font-medium mb-1">
                      {offer.type}
                    </div>
                    <h3 class="text-2xl font-bold text-secondary mb-2">
                      {offer.title}
                    </h3>
                    <p class="text-sm text-text-muted">{offer.partnerName}</p>
                  </div>

                  {/* Benefits */}
                  <ul class="space-y-2 mb-6">
                    {offer.benefits.map((benefit) => (
                      <li class="flex items-start gap-2">
                        <svg
                          class="w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"
                          fill="currentColor"
                          viewBox="0 0 20 20"
                        >
                          <path
                            fill-rule="evenodd"
                            d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                            clip-rule="evenodd"
                          />
                        </svg>
                        <span class="text-text-muted">{benefit}</span>
                      </li>
                    ))}
                  </ul>

                  {/* CTA */}
                  <Button
                    href={offer.ctaUrl}
                    variant={offer.highlight ? "success" : "primary"}
                    size="lg"
                    class="w-full md:w-auto"
                    data-event="partner_click"
                    data-partner={offer.partnerName}
                  >
                    {offer.cta}
                  </Button>
                </div>
              </div>
            </Card>
          ))
        }
      </div>
    </div>
  </Section>

  <!-- Why These Offers Section -->
  <Section background="surface" padding="lg">
    <div class="max-w-4xl mx-auto">
      <div class="text-center mb-8">
        <h2 class="text-2xl font-bold text-secondary mb-4">
          Por Que Estas Ofertas?
        </h2>
        <p class="text-text-muted">
          Selecionamos as melhores ofertas baseado no seu perfil
        </p>
      </div>

      <div class="grid md:grid-cols-3 gap-6">
        {
          [
            {
              icon: "üéØ",
              title: "Pr√©-Aprovadas",
              desc: "Todas as ofertas t√™m alta chance de aprova√ß√£o para voc√™",
            },
            {
              icon: "üíé",
              title: "Melhores Taxas",
              desc: "Negociamos taxas exclusivas com nossos parceiros",
            },
            {
              icon: "‚ö°",
              title: "Aprova√ß√£o R√°pida",
              desc: "Processo simplificado e decis√£o em minutos",
            },
          ].map((item) => (
            <div class="text-center">
              <div class="text-4xl mb-3">{item.icon}</div>
              <h3 class="font-bold text-secondary mb-2">{item.title}</h3>
              <p class="text-sm text-text-muted">{item.desc}</p>
            </div>
          ))
        }
      </div>
    </div>
  </Section>

  <!-- Additional Info -->
  <Section padding="lg">
    <div class="max-w-4xl mx-auto">
      <Card variant="elevated">
        <div class="md:flex items-center gap-6">
          <div class="text-5xl mb-4 md:mb-0">üì±</div>
          <div class="flex-1">
            <h3 class="text-xl font-bold text-secondary mb-2">
              Receba Suas Ofertas no WhatsApp
            </h3>
            <p class="text-text-muted mb-4">
              Enviamos todas as ofertas diretamente no seu WhatsApp para voc√™
              n√£o perder nenhuma oportunidade!
            </p>
            <p class="text-sm text-primary font-medium">
              Verifique suas mensagens para mais detalhes
            </p>
          </div>
        </div>
      </Card>
    </div>
  </Section>

  <!-- FAQ Section -->
  <Section background="surface" padding="lg">
    <div class="max-w-3xl mx-auto">
      <div class="text-center mb-8">
        <h2 class="text-2xl font-bold text-secondary mb-4">
          D√∫vidas Frequentes
        </h2>
      </div>

      <div class="space-y-4">
        {
          [
            {
              q: "As ofertas s√£o garantidas?",
              a: "As ofertas s√£o pr√©-aprovadas com base no seu perfil, mas a aprova√ß√£o final depende da an√°lise de cada institui√ß√£o financeira.",
            },
            {
              q: "Vou pagar algo pela consulta?",
              a: "N√£o! A consulta √© 100% gratuita. Voc√™ s√≥ paga se decidir contratar alguma das ofertas.",
            },
            {
              q: "Posso contratar mais de uma oferta?",
              a: "Sim! Voc√™ pode solicitar quantas ofertas quiser. Cada institui√ß√£o far√° sua pr√≥pria an√°lise.",
            },
            {
              q: "Quanto tempo leva para receber o cr√©dito?",
              a: "Depende da institui√ß√£o, mas geralmente o processo √© conclu√≠do em 24-48 horas ap√≥s a aprova√ß√£o.",
            },
          ].map((item) => (
            <Card>
              <h3 class="font-bold text-secondary mb-2">{item.q}</h3>
              <p class="text-text-muted text-sm">{item.a}</p>
            </Card>
          ))
        }
      </div>
    </div>
  </Section>

  <!-- Final CTA -->
  <Section background="dark" padding="lg">
    <div class="text-center max-w-3xl mx-auto">
      <h2 class="text-2xl font-bold text-white mb-4">
        N√£o Perca Estas Oportunidades!
      </h2>
      <p class="text-gray-300 mb-6">
        Estas ofertas s√£o exclusivas e por tempo limitado. Clique em "Solicitar"
        nas ofertas acima para garantir a sua.
      </p>
      <p class="text-sm text-gray-400">
        D√∫vidas? Entre em contato pelo WhatsApp: (11) 99999-9999
      </p>
    </div>
  </Section>

  <!-- Track CompleteRegistration -->
  <script>
    import { fbEvents } from "@lib/tracking";
    fbEvents.completeRegistration({
      contentName: "Results Page",
      contentCategory: "LEAD_GENERATION",
    });
  </script>

  <!-- Load lead data from localStorage -->
  <script>
    // Get lead data from localStorage
    const leadData = localStorage.getItem("leadData");
    if (leadData) {
      const data = JSON.parse(leadData);
      console.log("Lead data:", data);
      // Here you could send to your backend/CRM
    }
  </script>
</BaseLayout>
